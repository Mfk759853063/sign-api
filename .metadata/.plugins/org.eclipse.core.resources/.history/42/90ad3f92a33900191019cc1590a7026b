package com.porui.webapi.system.controller.labourer;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.aliyun.mns.common.HttpMethod;
import com.porui.hjl.common.core.vo.OutputObj;
import com.porui.hjl.commons.utils.StringUtils;
import com.porui.webapi.system.service.labourer.LabourerValidationService;

import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;

@Api(value = "民工相关接口",description = "民工验证接口")
@RestController
@RequestMapping(value = "/cgProgramApi/labourervalidation")
public class LabourerValidationController {
	
	private Logger logger = LoggerFactory.getLogger(LabourerValidationController.class);
	
	@Autowired
	LabourerValidationService validationService;
	
	@ApiOperation(value="通过身份证照片提取身份证信息", notes="通过身份证照片提取身份证信息")
	@RequestMapping(value = "/idCardNum", method = RequestMethod.GET)
	public OutputObj<String>  validationIdCard(
			@ApiParam(required = false, name = "idCard", value= "身份证照片地址")
			@RequestParam(required = true) String idCard,
			@ApiParam(required = false, name = "idCardType", value= "正面（头像）0 反面（国旗） 1")
			@RequestParam(required = false) String idCardType) {
		OutputObj<String> out = new OutputObj<String>();
    	try{
    		if (StringUtils.isEmpty(idCardType)) {
    			// 默认为头像面
				idCardType = "0";
			}
    		idCard = idCard.replaceAll("\\\\", "");
			String number = validationService.getIDCardNumber(idCard, idCardType);
			out.setData(number);
    		out.setMsg("成功");
    		out.setStatus("0");
    	}catch(Exception e){
    		logger.info("",e);
    		out.setMsg("失败");
    		out.setStatus("1");
    	}
    	return out;
	}
}
